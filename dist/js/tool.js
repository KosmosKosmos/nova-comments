(()=>{"use strict";var t,e={109:()=>{function t(t,e,n,r,s,o,a,i){var m,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(m=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=m):s&&(m=i?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),m)if(c.functional){c._injectStyles=m;var l=c.render;c.render=function(t,e){return m.call(e),l(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,m):[m]}return{exports:t,options:c}}const e=t({props:{moreStr:{type:String,default:"read more"},lessStr:{type:String,default:""},text:{type:String,required:!0},link:{type:String,default:"#"},maxChars:{type:Number,default:100}},data:()=>({isReadMore:!1}),computed:{formattedString(){var t=this.text;return!this.isReadMore&&this.text.length>this.maxChars&&(t=t.substring(0,this.maxChars)+"..."),t}},methods:{triggerReadMore(t,e){"#"==this.link&&t.preventDefault(),null===this.lessStr&&""===this.lessStr||(this.isReadMore=e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{domProps:{innerHTML:t._s(t.formattedString)}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.text.length>t.maxChars,expression:"text.length > maxChars"}]},[n("a",{directives:[{name:"show",rawName:"v-show",value:!t.isReadMore,expression:"!isReadMore"}],attrs:{href:t.link,id:"readmore"},on:{click:function(e){return t.triggerReadMore(e,!0)}}},[t._v(t._s(t.moreStr))]),t._v(" "),n("a",{directives:[{name:"show",rawName:"v-show",value:t.isReadMore,expression:"isReadMore"}],attrs:{href:t.link,id:"readmore"},on:{click:function(e){return t.triggerReadMore(e,!1)}}},[t._v(t._s(t.lessStr))])])])}),[],!1,null,null,null).exports;var n=t({props:{comment:{type:Object,required:!0}},components:{ReadMore:e},computed:{commentString:function(){return _.find(this.comment.fields,{attribute:"comment"}).value},commenter:function(){return _.find(this.comment.fields,{attribute:"commenter"}).value},commenterUrl:function(){var t=_.find(this.comment.fields,{attribute:"commenter"}).belongsToId;return"/nova/resources/users/".concat(t)},date:function(){var t=moment(),e=moment.utc(_.find(this.comment.fields,{attribute:"created_at"}).value).tz(moment.tz.guess());return e.isSame(t,"minute")?"just now":e.isSame(t,"day")?"at ".concat(e.format("LT")):e.isSame(t,"year")?"on ".concat(e.format("MMM D")):"on ".concat(e.format("ll"))},hasCommenter:function(){return Boolean(this.commenter)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"commenter__comment py-4 border-t border-40"},[n("div",{staticClass:"font-light text-80 text-sm"},[t.hasCommenter?[n("a",{staticClass:"no-underline dim text-primary font-bold",attrs:{href:t.commenterUrl},domProps:{textContent:t._s(t.commenter)}}),t._v("\n\n            said\n        ")]:[t._v(" Written ")],t._v("\n\n        "+t._s(t.date)+"\n    ")],2),t._v(" "),n("div",{staticClass:"mt-2"},[n("read-more",{attrs:{"more-str":">>>",text:t.commentString,link:"#","less-str":"<<<","max-chars":150}})],1)])}),[],!1,null,null,null);const r=t({props:["resourceName","resourceId","field"],components:{Comment:n.exports},data:function(){return{baseCommentUri:"/nova-api/comments",comment:"",data:{next_page_url:"",prev_page_url:"",resources:{}},isLoading:!1,isPosting:!1}},mounted:function(){this.getComments(this.commentsUri)},computed:{commentsUri:function(){return"".concat(this.baseCommentUri,"?page=1")},hasComments:function(){return Boolean(this.data.resources.length)},hasNextLink:function(){return Boolean(this.data.next_page_url)},hasPrevLink:function(){return Boolean(this.data.prev_page_url)},hasPagination:function(){return this.hasNextLink||this.hasPrevLink},queryParams:function(){return"&orderBy=created_at&orderByDirection=desc&viaResource=".concat(this.resourceName,"&viaResourceId=").concat(this.resourceId,"&viaRelationship=comments&relationshipType=hasMany")}},methods:{createComment:function(){var t=this;if(!this.comment)return!1;var e={comment:this.comment,viaResource:this.resourceName,viaResourceId:this.resourceId,viaRelationship:"comments"};this.isPosting=!0,axios.post(this.baseCommentUri,e).then((function(){t.isPosting=!1,t.getComments(t.commentsUri),t.resetComment(),t.$toasted.show("A new comment has been created.",{type:"success"})})).catch((function(e){t.isPosting=!1,t.$toasted.show(e,{type:"error"})}))},getComments:function(t){var e=this;this.setLoading(!0),axios.get("".concat(t).concat(this.queryParams)).then((function(t){var n=t.data;e.data=n,e.setLoading(!1)}))},paginationClass:function(t){return t?"text-primary dim":"text-80 opacity-50"},resetComment:function(){this.comment=""},setLoading:function(t){this.isLoading=t}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",{staticClass:"text-90 font-normal text-2xl mb-3"},[t._v("Comments")]),t._v(" "),n("div",{staticClass:"card mb-6 overflow-hidden"},[n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full pt-6 pb-2"},[n("h4",{staticClass:"font-normal text-80"},[t._v("Write new comment")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"w-full form-control form-input form-input-bordered py-3 h-auto mt-2",attrs:{id:"commenter",dusk:"commenter",rows:"5"},domProps:{value:t.comment},on:{keyup:function(e){return!e.type.indexOf("key")&&93!==e.keyCode&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.createComment.apply(null,arguments)},input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"flex justify-between px-8 pb-4 border-b border-40"},[n("div",{staticClass:"help-text"},[t._v("On MacOS, press âŒ˜ + Enter to save")]),t._v(" "),n("button",{staticClass:"btn btn-default btn-primary inline-flex items-center relative mt-4",attrs:{type:"submit",disabled:t.isPosting},on:{click:t.createComment}},[t._v("\n                Save Comment\n            ")])]),t._v(" "),n("loading-view",{attrs:{loading:t.isLoading}},[t.hasComments?n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full py-6"},[n("h3",{staticClass:"text-90 font-bold text-lg mb-4"},[t._v("Comments")]),t._v(" "),t._l(t.data.resources,(function(t,e){return n("comment",{key:e,attrs:{comment:t}})}))],2)]):t._e()]),t._v(" "),t.hasPagination?n("div",{staticClass:"bg-20 rounded-b"},[n("nav",{staticClass:"flex justify-between items-center"},[n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasNextLink),attrs:{disabled:!t.hasNextLink},on:{click:function(e){return t.getComments(t.data.next_page_url)}}},[t._v("\n                    Older\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasPrevLink),attrs:{disabled:!t.hasPrevLink},on:{click:function(e){return t.getComments(t.data.prev_page_url)}}},[t._v("\n                    Newer\n                ")])])]):t._e()],1)])}),[],!1,null,null,null).exports;Nova.booting((function(t){t.component("commenter",r)}))},429:()=>{}},n={};function r(t){var s=n[t];if(void 0!==s)return s.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.m=e,t=[],r.O=(e,n,s,o)=>{if(!n){var a=1/0;for(c=0;c<t.length;c++){for(var[n,s,o]=t[c],i=!0,m=0;m<n.length;m++)(!1&o||a>=o)&&Object.keys(r.O).every((t=>r.O[t](n[m])))?n.splice(m--,1):(i=!1,o<a&&(a=o));i&&(t.splice(c--,1),e=s())}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[n,s,o]},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={103:0,990:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var s,o,[a,i,m]=n,c=0;for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(m)var l=m(r);for(e&&e(n);c<a.length;c++)o=a[c],r.o(t,o)&&t[o]&&t[o][0](),t[a[c]]=0;return r.O(l)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),r.O(void 0,[990],(()=>r(109)));var s=r.O(void 0,[990],(()=>r(429)));s=r.O(s)})();